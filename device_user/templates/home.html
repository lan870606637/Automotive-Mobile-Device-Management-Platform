{% extends "base.html" %}

{% block title %}é¦–é¡µ - è®¾å¤‡ç®¡ç†ç³»ç»Ÿ{% endblock %}

{% set active_nav = 'home' %}

{% block content %}
<div class="home-page">
    <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
    <div class="user-header">
        <div class="user-info">
            <div class="user-avatar">{{ user.borrower_name[0] if user.borrower_name else '?' }}</div>
            <div class="user-detail">
                <h2>æ¬¢è¿ï¼Œ{{ user.borrower_name or 'æœªè®¾ç½®åç§°' }}</h2>
                <p class="user-phone">ğŸ“± {{ phone_mask }}</p>
            </div>
        </div>
        <a href="{{ url_for('logout') }}" class="logout-btn">é€€å‡ºç™»å½•</a>
    </div>
    
    <!-- å¿«æ·åŠŸèƒ½æŒ‰é’® -->
    <div class="quick-actions">
        <h3 class="section-title">å¿«æ·æ“ä½œ</h3>
        <div class="action-grid">
            <a href="{{ url_for('device_list', type='car') }}" class="action-item action-car">
                <div class="action-icon">ğŸš—</div>
                <span class="action-text">å€Ÿç”¨è½¦æœº</span>
            </a>
            <a href="{{ url_for('device_list', type='phone') }}" class="action-item action-phone">
                <div class="action-icon">ğŸ“±</div>
                <span class="action-text">å€Ÿç”¨æ‰‹æœº</span>
            </a>
            <a href="{{ url_for('my_records') }}" class="action-item action-record">
                <div class="action-icon">ğŸ“‹</div>
                <span class="action-text">å€Ÿç”¨è®°å½•</span>
            </a>
        </div>
    </div>
    
    <!-- å½“å‰å€Ÿç”¨è®¾å¤‡ -->
    <div class="borrowed-section">
        <h3 class="section-title">
            æˆ‘çš„å€Ÿç”¨
            {% if borrowed_devices %}
            <span class="badge">{{ borrowed_devices|length }}</span>
            {% endif %}
        </h3>
        
        {% if borrowed_devices %}
        <div class="device-list">
            {% for device in borrowed_devices %}
            <a href="{{ url_for('device_detail', device_id=device.id) }}" class="device-item {% if device.is_overdue %}device-overdue{% endif %}">
                <div class="device-icon">
                    {% if device.type == 'è½¦æœº' %}ğŸš—{% else %}ğŸ“±{% endif %}
                </div>
                <div class="device-info">
                    <div class="device-name">{{ device.name }}</div>
                    <div class="device-type">{{ device.type }}</div>
                    {% if device.expected_return_date %}
                    <div class="device-return-date {% if device.is_overdue %}overdue-text{% endif %}">
                        {% if device.is_overdue %}
                        âš ï¸ é€¾æœŸ {% if device.overdue_hours < 24 %}{{ device.overdue_hours }} å°æ—¶{% else %}{{ device.overdue_days }} å¤©{% endif %}
                        {% else %}
                        ğŸ“… é¢„è®¡å½’è¿˜: {{ device.expected_return_date }}
                        {% endif %}
                    </div>
                    {% endif %}
                </div>
                <div class="device-status">
                    {% if device.is_overdue %}
                    <span class="status-tag status-overdue">å·²é€¾æœŸ</span>
                    {% else %}
                    <span class="status-tag status-borrowed">å€Ÿç”¨ä¸­</span>
                    {% endif %}
                    <span class="arrow">â€º</span>
                </div>
            </a>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state">
            <div class="empty-icon">ğŸ“­</div>
            <p>æ‚¨å½“å‰æ²¡æœ‰å€Ÿç”¨è®¾å¤‡</p>
            <a href="{{ url_for('device_list') }}" class="btn btn-primary btn-small">å»å€Ÿè®¾å¤‡</a>
        </div>
        {% endif %}
    </div>
    
    <!-- ç³»ç»Ÿå…¬å‘Š -->
    <div class="notice-section">
        <h3 class="section-title">ğŸ“¢ ç³»ç»Ÿå…¬å‘Š</h3>
        <div class="notice-list">
            <div class="notice-item">
                <span class="notice-dot"></span>
                <p>è¯·çˆ±æŠ¤è®¾å¤‡ï¼ŒæŒ‰æ—¶å½’è¿˜</p>
            </div>
            <div class="notice-item">
                <span class="notice-dot"></span>
                <p>é‡åˆ°é—®é¢˜è¯·è”ç³»ç®¡ç†å‘˜</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
