<!-- 
  ç”µè„‘ç«¯åå°ç®¡ç† - ä»ªè¡¨ç›˜
  åŠŸèƒ½ï¼šæ•°æ®ç»Ÿè®¡ã€å¿«æ·å…¥å£ã€æœ€è¿‘æ´»åŠ¨
-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åå°ä»ªè¡¨ç›˜ - è½¦è½½æµ‹è¯•è®¾å¤‡ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="/static/admin/admin_pc.css">
</head>
<body class="pc-admin-body">
    <div class="pc-admin-wrapper">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <span class="logo">ğŸ”§</span>
                <span class="logo-text">åå°ç®¡ç†</span>
            </div>
            <nav class="sidebar-nav">
                <a href="/admin/pc/dashboard" class="nav-item active">
                    <span class="nav-icon">ğŸ“Š</span>
                    <span>ä»ªè¡¨ç›˜</span>
                </a>
                <a href="/admin/pc/devices" class="nav-item">
                    <span class="nav-icon">ğŸ“±</span>
                    <span>è®¾å¤‡ç®¡ç†</span>
                </a>
                <a href="/admin/pc/users" class="nav-item">
                    <span class="nav-icon">ğŸ‘¥</span>
                    <span>ç”¨æˆ·ç®¡ç†</span>
                </a>
                <a href="/admin/pc/records" class="nav-item">
                    <span class="nav-icon">ğŸ“‹</span>
                    <span>è®°å½•æŸ¥è¯¢</span>
                </a>
                <a href="/admin/pc/logs" class="nav-item">
                    <span class="nav-icon">ğŸ“œ</span>
                    <span>æ“ä½œæ—¥å¿—</span>
                </a>
                <a href="/admin/pc/overdue" class="nav-item">
                    <span class="nav-icon">âš ï¸</span>
                    <span>è¿‡æœŸæœªè¿˜</span>
                    {% if overdue_count > 0 %}
                    <span class="nav-badge">{{ overdue_count }}</span>
                    {% endif %}
                </a>
                <a href="/admin/pc/announcements" class="nav-item">
                    <span class="nav-icon">ğŸ“¢</span>
                    <span>å…¬å‘Šç®¡ç†</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <span>ğŸ‘¤ {{ admin_name }}</span>
                <a href="/admin/logout" class="logout-btn">é€€å‡º</a>
            </div>
        </aside>

        <!-- ä¸»å†…å®¹åŒº -->
        <main class="main-content">
            <!-- é¡¶éƒ¨æ  -->
            <header class="content-header">
                <h1>ä»ªè¡¨ç›˜</h1>
                <div class="header-actions">
                    <a href="/admin/pc/device/add" class="btn btn-primary">â• æ–°å¢è®¾å¤‡</a>
                </div>
            </header>

            <!-- ç»Ÿè®¡å¡ç‰‡ -->
            <div class="stats-row">
                <div class="stat-card-large total">
                    <div class="stat-icon-bg">ğŸ“¦</div>
                    <div class="stat-info">
                        <span class="stat-value">{{ total_devices }}</span>
                        <span class="stat-label">æ€»è®¾å¤‡æ•°</span>
                    </div>
                </div>
                <div class="stat-card-large available">
                    <div class="stat-icon-bg">âœ…</div>
                    <div class="stat-info">
                        <span class="stat-value">{{ available_devices }}</span>
                        <span class="stat-label">åœ¨åº“è®¾å¤‡</span>
                    </div>
                </div>
                <div class="stat-card-large borrowed">
                    <div class="stat-icon-bg">ğŸ“¤</div>
                    <div class="stat-info">
                        <span class="stat-value">{{ borrowed_devices }}</span>
                        <span class="stat-label">å·²å€Ÿå‡º</span>
                    </div>
                </div>
                <div class="stat-card-large overdue">
                    <div class="stat-icon-bg">âš ï¸</div>
                    <div class="stat-info">
                        <span class="stat-value">{{ overdue_devices }}</span>
                        <span class="stat-label">å·²é€¾æœŸ</span>
                    </div>
                </div>
            </div>

            <!-- è®¾å¤‡ç±»å‹ç»Ÿè®¡ -->
            <div class="stats-row">
                <div class="stat-card-half">
                    <h3>è®¾å¤‡ç±»å‹åˆ†å¸ƒ</h3>
                    <div class="type-stats">
                        <div class="type-stat-item">
                            <span class="type-icon">ğŸ“±</span>
                            <div class="type-info">
                                <span class="type-count">{{ phone_count }} å°</span>
                                <span class="type-label">æ‰‹æœº</span>
                            </div>
                        </div>
                        <div class="type-stat-item">
                            <span class="type-icon">ğŸš—</span>
                            <div class="type-info">
                                <span class="type-count">{{ car_device_count }} å°</span>
                                <span class="type-label">è½¦æœº</span>
                            </div>
                        </div>
                        <div class="type-stat-item">
                            <span class="type-icon">ğŸ“Š</span>
                            <div class="type-info">
                                <span class="type-count">{{ instrument_count }} å°</span>
                                <span class="type-label">ä»ªè¡¨</span>
                            </div>
                        </div>
                        <div class="type-stat-item">
                            <span class="type-icon">ğŸ“²</span>
                            <div class="type-info">
                                <span class="type-count">{{ simcard_count }} å°</span>
                                <span class="type-label">æ‰‹æœºå¡</span>
                            </div>
                        </div>
                        <div class="type-stat-item">
                            <span class="type-icon">ğŸ”§</span>
                            <div class="type-info">
                                <span class="type-count">{{ other_device_count }} å°</span>
                                <span class="type-label">å…¶å®ƒè®¾å¤‡</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="stat-card-half">
                    <h3>çŠ¶æ€åˆ†å¸ƒ</h3>
                    <div class="status-bars">
                        <div class="status-bar-item">
                            <span class="status-name">åœ¨åº“</span>
                            <div class="status-bar">
                                <div class="status-progress" style="width: {{ available_percent }}%; background: #4CAF50;"></div>
                            </div>
                            <span class="status-percent">{{ available_percent }}%</span>
                        </div>
                        <div class="status-bar-item">
                            <span class="status-name">å€Ÿå‡º</span>
                            <div class="status-bar">
                                <div class="status-progress" style="width: {{ borrowed_percent }}%; background: #FF9800;"></div>
                            </div>
                            <span class="status-percent">{{ borrowed_percent }}%</span>
                        </div>
                        <div class="status-bar-item">
                            <span class="status-name">å…¶ä»–</span>
                            <div class="status-bar">
                                <div class="status-progress" style="width: {{ other_percent }}%; background: #9e9e9e;"></div>
                            </div>
                            <span class="status-percent">{{ other_percent }}%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æœ€è¿‘æ´»åŠ¨å’Œé€¾æœŸè®¾å¤‡ -->
            <div class="content-row">
                <div class="content-card">
                    <div class="card-header">
                        <h3>æœ€è¿‘æ“ä½œè®°å½•</h3>
                        <a href="/admin/pc/records" class="view-all">æŸ¥çœ‹å…¨éƒ¨ â†’</a>
                    </div>
                    <div class="record-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>æ“ä½œ</th>
                                    <th>è®¾å¤‡</th>
                                    <th>ç”¨æˆ·</th>
                                    <th>æ—¶é—´</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if recent_records %}
                                    {% for record in recent_records[:10] %}
                                    <tr>
                                        <td><span class="action-badge action-{{ record.action_type }}">{{ record.action_type }}</span></td>
                                        <td>{{ record.device_name }}</td>
                                        <td>{{ record.user_name }}</td>
                                        <td>{{ record.time }}</td>
                                    </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="4" class="empty-cell">æš‚æ— è®°å½•</td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="content-card">
                    <div class="card-header">
                        <h3>é€¾æœŸè®¾å¤‡</h3>
                        <a href="/admin/pc/overdue" class="view-all">æŸ¥çœ‹å…¨éƒ¨ â†’</a>
                    </div>
                    <div class="overdue-list">
                        {% if overdue_devices_list %}
                            {% for device in overdue_devices_list[:5] %}
                            <div class="overdue-item">
                                <div class="overdue-device">
                                    <span class="device-icon">{{ 'ğŸ“±' if device.device_type == 'æ‰‹æœº' else 'ğŸš—' }}</span>
                                    <span>{{ device.device_name }}</span>
                                </div>
                                <div class="overdue-info">
                                    <span class="overdue-user">ğŸ‘¤ {{ device.borrower }}</span>
                                    <span class="overdue-days">é€¾æœŸ {% if device.overdue_hours < 24 %}{{ device.overdue_hours }} å°æ—¶{% else %}{{ device.overdue_days }} å¤©{% endif %}</span>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="empty-state">
                                <span>âœ… æš‚æ— é€¾æœŸè®¾å¤‡</span>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toastæç¤º -->
    <div id="toast" class="toast"></div>

    <script>
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }
    </script>
</body>
</html>
